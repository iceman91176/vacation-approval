<form class="form-horizontal"
      role="form" name="approveForm" >

  <p>Möchtest Du die Vertretung übernehmen ?</p>

  <div class="form-group">
    <label class="control-label col-md-2">Antragsteller</label>
    <div class="col-md-10">
      <input cam-variable-name="leaveRequester"
             type="text"
             name="leaveRequester"
             readonly="true"
             class="form-control" />
    </div>
  </div>
  
  <div class="form-group">
    <label class="control-label col-md-2">Erster Tag der Abwesenheit</label>
    <div class="col-md-10">
    <span class="form-control">{{ leaveStartDate | date:'dd.MM.yyyy' }}</span>
    </div>
  </div>
  <div class="form-group">
    <label class="control-label col-md-2">Letzer Tag der Abwesenheit</label>
    <div class="col-md-10">
    <span class="form-control">{{ leaveEndDate | date:'dd.MM.yyyy' }}</span>
    </div>
  </div>
  
  
  <div class="form-group" ng-show="!substitute_approved" ng-class="{ 'has-error' : approveForm.rejectremark.$invalid && !approveForm.rejectremark.$pristine }">
  <label class="control-label col-md-2">Grund für Ablehnung</label>
      <div class="col-md-10">
        <textarea class="form-control"
                  cam-variable-name="SUBSTITUTE_REJECT_REMARK"
                  cam-variable-type="String"
                  rows="4"
                  ng-required="!substitute_approved"
                  name="rejectremark"
                  ></textarea>
      <p ng-show="approveForm.rejectremark.$invalid" class="help-block">Ablehungsgrund angeben.</p>            
      </div>
 </div> 
<!-- 
 <div class="form-group" ng-show="!substitute_approved">
      <label class="control-label col-md-2">Grund für Ablehnung</label>
      <div class="col-md-10">
        <textarea class="form-control"
                  cam-variable-name="SUBSTITUTE_REJECT_REMARK"
                  cam-variable-type="String"
                  rows="4"
                  ng-required="!substitute_approved"
                  name="rejectremark"
                  ></textarea>
      </div>
    </div>
       <p ng-if="approveForm.rejectremark.$invalid" style="color: red">
        Bitte Ablehnungsgrund angeben.
      </p>
 -->
  <div class="form-group">
    <div class="col-md-10 col-md-offset-2">
      <div class="checkbox">
        <label>
          <input cam-variable-name="substitute_approved"
                 cam-variable-type="Boolean"
                 type="checkbox"
                 name="substitute_approved"
                 class="form-control" checked/>
          Stellvertretung übernehmen?
        </label>
      </div>
    </div>
  </div>
  
  <script cam-script type="text/form-script">
  
  inject([ '$filter', function($filter) { 
  
  var variableManager = camForm.variableManager;

  $scope.leaveStartDate = null;
	$scope.leaveEndDate = null;

  camForm.on('form-loaded', function() {
    // fetch the variable 'customVariable'
    console.log('form loaded');
    variableManager.fetchVariable('LEAVE_START_DATE');
    variableManager.fetchVariable('LEAVE_END_DATE');
    
  });

  camForm.on('variables-fetched', function() {
    // value has been fetched, bind to $scope.customerId
    //$scope.leaveStartDate = $filter('date')(variableManager.variable('LEAVE_START_DATE').value,'yyyy-MM-dd HH:mm:ss');
    //$scope.leaveEndDate = $filter('date')(variableManager.variable('LEAVE_END_DATE').value,'yyyy-MM-dd HH:mm:ss');
	$scope.leaveStartDate = variableManager.variable('LEAVE_START_DATE').value;
	$scope.leaveEndDate = variableManager.variable('LEAVE_END_DATE').value;

    
  });

  camForm.on('submit', function(evt) {
	//console.log('form submit' + $scope.leaveStartDate + " convert to " + $filter('date')($scope.leaveStartDate,'yyyy-MM-ddTHH:mm:ss'));
	variableManager.variableValue('LEAVE_START_DATE',$filter('date')($scope.leaveStartDate,'yyyy-MM-ddTHH:mm:ss'));
	variableManager.variableValue('LEAVE_END_DATE',$filter('date')($scope.leaveEndDate,'yyyy-MM-ddTHH:mm:ss'));

    
  });
  }]);
	</script>
  
 {{ testVar | date:'yyyy-MM-ddTHH:mm:ss' }}
  
</form>
